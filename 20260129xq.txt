系统核心目标
开发一个水质检测原始数据管理模块集成到现在的水质报告系统中，实现 Excel 数据自动化入库、样品编号精准查询、定制化指标模板导出，支撑水质检测数据的录入、查询、筛选、导出全流程管理。
功能模块与详细需求
1. 数据录入模块
输入：用户上传包含水质检测数据的 Excel 文件；
核心列名规则：系统列名由首次导入的 Excel 列名确定并固化，后续导入原始记录时需校验列名一致性（列名完全匹配方可入库，不匹配则提示异常并终止本次导入），列名无别名兼容逻辑；
数据维度分类及校验规则：
基础属性：
样品编号：唯一标识，录入时强制校验唯一性（重复编号提示用户选择 “覆盖 / 跳过 / 终止入库”），编号格式不固定、无需校验格式合法性；
所属公司、所属水厂、水样类型：文本型，无额外校验规则；
采样时间：仅接受 “4 位年 - 2 位月 - 2 位日” 格式（如 “2026-01-29”），非该格式判定为无效，提示异常且对应行不入库；
检测指标：大部分为数值型、少部分为文本型，空值 / 异常值均直接入库（无拦截、无修正），数值型指标保留导入数据的原始小数点位数；
核心逻辑：
首次导入：提取 Excel 列名作为系统基准列名并存储；
非首次导入：先校验列名与系统基准列名完全一致，再依次完成采样时间格式校验、样品编号唯一性校验；
校验失败项给出明确提示（如 “列名不匹配：缺少‘采样时间’列”“采样时间‘2026.01.29’格式错误”“样品编号 XXX 重复”），支持跳过错误行继续入库（采样时间 / 编号错误行除外）。
2. 精准查询模块
功能：通过 “样品编号” 精确检索数据；
输出：返回该编号对应的所有数据（所属公司、水厂、水样类型、采样时间、全部检测指标），支持可视化表格展示 + 单条数据导出（Excel/CSV）。
3. 定制化模板与筛选导出模块
子功能 3.1：模板管理
模板创建：支持自定义分类命名（如 “出厂水 - 常规指标”“水源水 - 重金属”），模板内容为 “自定义分类 + 模板名称 + 选定的若干检测指标”；
模板操作：支持模板的修改、删除，分类支持新增、删除；
存储规则：模板需持久化存储至数据库，便于重复使用。
子功能 3.2：筛选与导出
筛选规则：
筛选维度：所属公司、所属水厂、水样类型、采样时间范围（单维度筛选，暂不支持多条件组合）；
模糊匹配：文本类维度（公司 / 水厂 / 水样类型）的筛选为 “包含匹配”（如输入 “水务” 匹配所有名称含 “水务” 的记录）；
导出逻辑：
选择已创建的定制化指标模板；
对筛选后的样品编号，支持 “全选” 或 “手动勾选” 选定导出范围；
导出数据按 “采样时间升序 / 降序” 排列；
生成 Excel 数据表，格式要求：行为采样时间，列为选定的检测指标，包含样品编号作为基础标识列；数值型指标保留原始小数点位数；
导出文件命名规则：按导出时间命名（如 “20260129153000.xlsx”，格式为 YYYYMMDDHHMMSS）。