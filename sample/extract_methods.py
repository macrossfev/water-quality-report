#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
从Scan_0001.pdf提取水质检测项目及检测方法，生成Excel报告
"""

import pandas as pd
from datetime import datetime

# 检测项目及方法数据
data = [
    {
        "序号": 1,
        "检测项目": "水温",
        "检测方法": "温度计/薄膜面温度计",
        "方法依据/标准": "GB/T 13195-1991",
        "仪器设备": "温度计 ZB1861706",
        "备注": ""
    },
    {
        "序号": 2,
        "检测项目": "pH值",
        "检测方法": "玻璃电极法",
        "方法依据/标准": "GB/T 5750.4-2023 中8.1",
        "仪器设备": "台式酸度计 ORIONSTAR A221 (CSJ-ZJ-091)",
        "备注": "标准缓冲溶液校正"
    },
    {
        "序号": 3,
        "检测项目": "色度",
        "检测方法": "铂-钴标准比色法",
        "方法依据/标准": "GB/T 5750.4-2023 (4.1)",
        "仪器设备": "成套高型无色玻璃比色管50ml",
        "备注": "目视法"
    },
    {
        "序号": 4,
        "检测项目": "浊度",
        "检测方法": "散射法-福尔马肼标准",
        "方法依据/标准": "GB/T 5750.4-2023 (5.1)",
        "仪器设备": "浊度计 2100N",
        "备注": ""
    },
    {
        "序号": 5,
        "检测项目": "臭和味",
        "检测方法": "嗅觉和味觉",
        "方法依据/标准": "GB/T 5750.4-2023 (6.1)(7.1)",
        "仪器设备": "-",
        "备注": "感官评定"
    },
    {
        "序号": 6,
        "检测项目": "肉眼可见物",
        "检测方法": "直接观察法",
        "方法依据/标准": "GB/T 5750.4-2023",
        "仪器设备": "-",
        "备注": "目视检查"
    },
    {
        "序号": 7,
        "检测项目": "高锰酸盐指数(耗氧量)",
        "检测方法": "酸性高锰酸钾滴定法",
        "方法依据/标准": "GB/T 5750.7-2023 (4.1)",
        "仪器设备": "滴定管 ZB2330299",
        "备注": "标准溶液浓度0.01007 moL/L"
    },
    {
        "序号": 8,
        "检测项目": "溶解氧(DO)",
        "检测方法": "电化学探头法",
        "方法依据/标准": "HJ 506-2009 《水质溶解氧的测定电化学探头法》",
        "仪器设备": "便携式溶解氧仪 HQ30d (CSJ-ZJ-090)",
        "备注": ""
    },
    {
        "序号": 9,
        "检测项目": "化学需氧量(COD)",
        "检测方法": "快速消解分光光度法",
        "方法依据/标准": "HJ/T 399-2007 《水质 化学需氧量的测定 快速消解分光光度法》",
        "仪器设备": "DBR200型数字式反应器(CSJ-FJ-080), DR3900型分光光度计(CSJ-ZJ-079)",
        "备注": "反应条件: 150℃, 2h"
    },
    {
        "序号": 10,
        "检测项目": "五日生化需氧量(BOD5)",
        "检测方法": "稀释与接种法",
        "方法依据/标准": "HJ 505-2009 《水质 五日生化需氧量(BOD5)的测定 稀释与接种法》",
        "仪器设备": "生化培养箱 SPX-150III(CSJ-FJ-142), 溶解氧仪 HQ30d(CSJ-ZJ-090)",
        "备注": "生化培养箱型号、编号、温度 20℃ 5d"
    },
    {
        "序号": 11,
        "检测项目": "电导率",
        "检测方法": "电极法",
        "方法依据/标准": "GB/T 5750.4-2023 中9.1",
        "仪器设备": "电导率/TDS测定 Sension5 (CSJ-ZJ-027)",
        "备注": "标准溶液校准值(μS/cm): 180"
    },
    {
        "序号": 12,
        "检测项目": "菌落总数",
        "检测方法": "平皿计数法",
        "方法依据/标准": "GB/T 5750.12-2023 (4.1)",
        "仪器设备": "电热压力蒸汽消毒器YXQ-LS-50A(CSJ-FJ-117), 隔水式电热恒温培养箱PYX-DHS.500-BY(CSJ-FJ-181)",
        "备注": "培养温度36±1℃, 培养时间48±2h"
    },
    {
        "序号": 13,
        "检测项目": "总大肠菌群",
        "检测方法": "滤膜法 / 酶底物法",
        "方法依据/标准": "GB/T 5750.12-2023 (5.2) / HJ 1001-2018",
        "仪器设备": "电热压力蒸汽消毒器YXQ-LS-50A(CSJ-FJ-117), 隔水式电热恒温培养箱PYX-DHS.500-BY(CSJ-FJ-197)",
        "备注": "培养温度36±1℃, 24±2h"
    },
    {
        "序号": 14,
        "检测项目": "耐热大肠菌群",
        "检测方法": "滤膜法",
        "方法依据/标准": "GB/T 5750.12-2023 (6.2)",
        "仪器设备": "电热压力蒸汽消毒器YXQ-LS-50A(CSJ-FJ-117), 隔水式培养箱PYX-DHS.500BY(CSJ-FJ-151)",
        "备注": "培养温度44.5±0.5℃, 24±2h"
    },
    {
        "序号": 15,
        "检测项目": "大肠埃希氏菌",
        "检测方法": "滤膜法 / 酶底物法",
        "方法依据/标准": "GB/T 5750.12-2023 (7.2) / HJ 1001-2018",
        "仪器设备": "电热压力蒸汽消毒器YXQ-LS-50A(CSJ-FJ-117), 隔水式电热恒温培养箱PYX-DHS.500-BY(CSJ-FJ-197)",
        "备注": "培养温度36±1℃, 4h; 紫外线灯检查"
    },
    {
        "序号": 16,
        "检测项目": "贾第氏虫孢囊数",
        "检测方法": "待定",
        "方法依据/标准": "-",
        "仪器设备": "-",
        "备注": "表中未检出"
    },
    {
        "序号": 17,
        "检测项目": "隐孢子虫卵囊数",
        "检测方法": "待定",
        "方法依据/标准": "-",
        "仪器设备": "-",
        "备注": "表中未检出"
    },
    {
        "序号": 18,
        "检测项目": "粪大肠菌群",
        "检测方法": "酶底物法",
        "方法依据/标准": "HJ 1001-2018 《水质总大肠菌群、粪大肠菌群和大肠埃希氏菌的测定》",
        "仪器设备": "隔水式电热恒温培养箱 PYX-DHS.500-BY(CSJ-FJ-151)",
        "备注": "培养温度44.5±0.5℃, 24h"
    },
    {
        "序号": 19,
        "检测项目": "藻类",
        "检测方法": "待定",
        "方法依据/标准": "-",
        "仪器设备": "-",
        "备注": "表中有记录但未见详细方法"
    },
    {
        "序号": 20,
        "检测项目": "三氯甲烷",
        "检测方法": "顶空气相色谱法",
        "方法依据/标准": "GB/T 5750.8-2023 中4.3 《生活饮用水标准检验方法 第8部分：有机物指标》顶空毛细管柱气相色谱法",
        "仪器设备": "气相色谱仪 Agilent 7890A (CSJ-ZJ-068), 色谱柱: HP-5MS, 检测器: ECD",
        "备注": "标准曲线浓度范围: 0.0100-0.100 mg/L"
    },
    {
        "序号": 21,
        "检测项目": "四氯化碳",
        "检测方法": "顶空气相色谱法",
        "方法依据/标准": "GB/T 5750.8-2023 中4.3 《生活饮用水标准检验方法 第8部分：有机物指标》顶空毛细管柱气相色谱法",
        "仪器设备": "气相色谱仪 Agilent 7890A (CSJ-ZJ-068), 色谱柱: HP-5MS, 检测器: ECD",
        "备注": "标准曲线浓度范围: 0.0100-0.100 mg/L"
    },
    {
        "序号": 22,
        "检测项目": "一氯二溴甲烷",
        "检测方法": "顶空气相色谱法",
        "方法依据/标准": "GB/T 5750.8-2023 中4.3 《生活饮用水标准检验方法 第8部分：有机物指标》顶空毛细管柱气相色谱法",
        "仪器设备": "气相色谱仪 Agilent 7890A (CSJ-ZJ-068), 色谱柱: HP-5MS, 检测器: ECD",
        "备注": "标准曲线浓度范围: 0.0100-0.100 mg/L"
    },
    {
        "序号": 23,
        "检测项目": "二氯二溴甲烷",
        "检测方法": "顶空气相色谱法",
        "方法依据/标准": "GB/T 5750.8-2023 中4.3 《生活饮用水标准检验方法 第8部分：有机物指标》顶空毛细管柱气相色谱法",
        "仪器设备": "气相色谱仪 Agilent 7890A (CSJ-ZJ-068), 色谱柱: HP-5MS, 检测器: ECD",
        "备注": "标准曲线浓度范围: 0.0100-0.100 mg/L"
    },
    {
        "序号": 24,
        "检测项目": "三溴甲烷",
        "检测方法": "顶空气相色谱法",
        "方法依据/标准": "GB/T 5750.8-2023 中4.3 《生活饮用水标准检验方法 第8部分：有机物指标》顶空毛细管柱气相色谱法",
        "仪器设备": "气相色谱仪 Agilent 7890A (CSJ-ZJ-068), 色谱柱: HP-5MS, 检测器: ECD",
        "备注": "标准曲线浓度范围: 0.0100-0.100 mg/L"
    },
    {
        "序号": 25,
        "检测项目": "三卤甲烷(总量)",
        "检测方法": "计算法",
        "方法依据/标准": "基于单个卤代甲烷的检测结果计算",
        "仪器设备": "-",
        "备注": "三氯甲烷、一氯二溴甲烷、二氯二溴甲烷、三溴甲烷的浓度比之和"
    }
]

# 创建DataFrame
df = pd.DataFrame(data)

# 生成Excel文件
output_file = '/home/macrossfev/water-quality-report/sample/水质检测项目及方法汇总表.xlsx'

# 创建Excel writer对象
with pd.ExcelWriter(output_file, engine='openpyxl') as writer:
    df.to_excel(writer, sheet_name='检测项目及方法', index=False)

    # 获取工作表
    workbook = writer.book
    worksheet = writer.sheets['检测项目及方法']

    # 设置列宽
    worksheet.column_dimensions['A'].width = 8
    worksheet.column_dimensions['B'].width = 25
    worksheet.column_dimensions['C'].width = 30
    worksheet.column_dimensions['D'].width = 50
    worksheet.column_dimensions['E'].width = 60
    worksheet.column_dimensions['F'].width = 30

    # 设置标题行样式
    from openpyxl.styles import Font, Alignment, PatternFill, Border, Side

    header_fill = PatternFill(start_color='4472C4', end_color='4472C4', fill_type='solid')
    header_font = Font(bold=True, color='FFFFFF', size=11)
    header_alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)

    for cell in worksheet[1]:
        cell.fill = header_fill
        cell.font = header_font
        cell.alignment = header_alignment

    # 设置数据行样式
    thin_border = Border(
        left=Side(style='thin'),
        right=Side(style='thin'),
        top=Side(style='thin'),
        bottom=Side(style='thin')
    )

    for row in worksheet.iter_rows(min_row=2, max_row=len(df)+1):
        for cell in row:
            cell.alignment = Alignment(vertical='center', wrap_text=True)
            cell.border = thin_border

    # 冻结首行
    worksheet.freeze_panes = 'A2'

print(f"✓ Excel文件已生成: {output_file}")
print(f"✓ 共提取 {len(data)} 个检测项目及其检测方法")
print("\n主要检测项目包括:")
print("  - 常规指标: 水温、pH、色度、浊度、臭和味、肉眼可见物、电导率")
print("  - 化学指标: 高锰酸盐指数、溶解氧、化学需氧量、五日生化需氧量")
print("  - 微生物指标: 菌落总数、总大肠菌群、耐热大肠菌群、大肠埃希氏菌、粪大肠菌群")
print("  - 有机物指标: 三氯甲烷、四氯化碳、一氯二溴甲烷、二氯二溴甲烷、三溴甲烷、三卤甲烷")
